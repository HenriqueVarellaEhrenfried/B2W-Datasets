Acho que tem algumas funções que poderiam melhorar.